class Solution {
public:
    int maxDistance(vector<vector<int>>& arrays) {
        int m = arrays.size();
        int maxDiff = 0;
        int bestMax = arrays[0].back();
        int bestMin = arrays[0][0];
        for(int i = 1; i < m; i++){
            int currMax = arrays[i].back();
            int currMin = arrays[i][0];
            maxDiff = max(maxDiff, currMax - bestMin); 
            maxDiff = max(maxDiff, bestMax - currMin); 
            bestMin = min(bestMin, currMin);
            bestMax = max(bestMax, currMax);
        }
        return maxDiff;
    }
};
